<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Form</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="form-container">
        <h2>Join our team, where every day is an opportunity to impact lives positively.</h2>
        <p>Weâ€™re looking for dedicated individuals who value growth, teamwork, and compassion. Apply now to be part of a supportive community and advance your career!</p>

        <form action="#" method="POST" enctype="multipart/form-data">
            <div class="form-row">
                <div class="form-group">
                    <label>First Name *</label>
                    <input type="text" name="first_name" required>
                </div>
                <div class="form-group">
                    <label>Last Name *</label>
                    <input type="text" name="last_name" required>
                </div>
            </div>

            <label>Email Address *</label>
            <input type="email" name="email" required>

            <label>Phone *</label>
            <input type="tel" name="phone" maxlength="10" required>

            <label>Country *</label>
            <select name="country" id="country" required>
                <option value="US" selected>United States</option>
            </select>

            <label>State/Province *</label>
            <select name="state" id="state" required>
                <option value="">Select a State</option>
            </select>

            <label>City *</label>
            <select name="city" id="city" required>
                <option value="">Select a City</option>
            </select>

            <label>ZIP / Postal Code *</label>
            <input type="text" name="zip" id="zip" required>

            <button type="submit">Send Message</button>
        </form>
    </div>

    <script>
        const rapidApiKey = '7d95aac0d5msh11d5faaf9487d69p17991djsnc910d79fcaf5';

        // Function to fetch and populate states for the US
        async function fetchStates() {
            try {
                let response = await fetch('https://wft-geo-db.p.rapidapi.com/v1/geo/countries/US/regions', {
                    method: 'GET',
                    headers: {
                        'X-RapidAPI-Key': rapidApiKey,
                        'X-RapidAPI-Host': 'wft-geo-db.p.rapidapi.com'
                    }
                });
                
                if (!response.ok) {
                    console.error(`Error fetching states: ${response.status} ${response.statusText}`);
                    const errorText = await response.text();
                    console.error("Response body:", errorText);
                    return;
                }
                
                let data = await response.json();
                let stateSelect = document.getElementById('state');
                stateSelect.innerHTML = '<option value="">Select a State</option>'; // Reset state dropdown

                data.data.forEach(state => {
                    let option = document.createElement('option');
                    option.value = state.code;
                    option.text = state.name;
                    stateSelect.appendChild(option);
                });
            } catch (error) {
                console.error("Error fetching states:", error);
            }
        }

        // Function to fetch and populate cities based on selected state in the US
        async function fetchCities(stateCode) {
            try {
                let response = await fetch(`https://wft-geo-db.p.rapidapi.com/v1/geo/countries/US/regions/${stateCode}/cities`, {
                    method: 'GET',
                    headers: {
                        'X-RapidAPI-Key': rapidApiKey,
                        'X-RapidAPI-Host': 'wft-geo-db.p.rapidapi.com'
                    }
                });
                
                if (!response.ok) {
                    console.error(`Error fetching cities: ${response.status} ${response.statusText}`);
                    const errorText = await response.text();
                    console.error("Response body:", errorText);
                    return;
                }
                
                let data = await response.json();
                let citySelect = document.getElementById('city');
                citySelect.innerHTML = '<option value="">Select a City</option>'; // Reset city dropdown

                data.data.forEach(city => {
                    let option = document.createElement('option');
                    option.value = city.name;
                    option.text = city.name;
                    citySelect.appendChild(option);
                });
            } catch (error) {
                console.error("Error fetching cities:", error);
            }
        }

        // Populate states on page load
        document.addEventListener('DOMContentLoaded', () => {
            fetchStates(); // Fetch states for the US when the page loads
        });

        // Event listener for when a state is selected
        document.getElementById('state').addEventListener('change', function() {
            let stateCode = this.value;
            if (stateCode) {
                fetchCities(stateCode); // Fetch cities based on selected state
            } else {
                document.getElementById('city').innerHTML = '<option value="">Select a City</option>';
            }
        });
    </script>
</body>
</html>
